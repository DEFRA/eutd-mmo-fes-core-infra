name: $(BuildID)

trigger: none

# schedules:
#   - cron: "30 6 * * 1-5"
#     displayName: Daily Deploy at 6:30 AM UTC
#     branches:
#       include:
#         - main
#     always: true

resources:
  repositories:
    - repository: MMOPipelineCommon
      name: "DEFRA/eutd-mmo-fes-pipeline-common"
      endpoint: DEFRA
      type: github
      ref: refs/heads/main

extends:
  template: /includes/scripts-deploy.yaml@MMOPipelineCommon
  parameters:
    scriptsList:
      - displayName: "Import Reference LogicApps Workflow"
        scriptRepo: MMOPipelineCommon
        scriptPath: "scripts/Import-Workflows.ps1"
        ScriptArguments: -LogicAppRG "$(resourceGroupName)" -storageAccountRGName "$(storageAccountRGName)" -LogicAppName "$(logicappsrefdataName)" -StorageAccountName "$(storageAccountName)"
      - displayName: "Import Processor LogicApps Workflow"
        scriptRepo: MMOPipelineCommon
        scriptPath: "scripts/Import-Workflows.ps1"
        ScriptArguments: -LogicAppRG "$(resourceGroupName)" -storageAccountRGName "$(storageAccountRGName)" -LogicAppName "$(logicappsprocessorName)" -StorageAccountName "$(storageAccountName)"
